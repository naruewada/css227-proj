<%- include('partials/header.ejs') %>

<script src="/home.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="../stylesheets/mypage.css">


    <div class="cinema-show">

        <div class="alert alert-success mypage-background" role="alert">
            <p class="movie-head">MY PROFILE</p>
            <img src="<%= currentUser.picture %>" alt="" style="width: 50px; height: 50px;">
            <p class="user-detail"><span class="mypage-edit">Username : <%= currentUser.username %></span><br>
                <span class="mypage-edit">First name : <%= currentUser.firstname %></span><br>
                <span class="mypage-edit">Last name : <%= currentUser.lastname %></span><br><br>
                <a href="#"><button class="mypage-edit-button"><i class="fa fa-edit"></i>Edit</button></a>
            </p>
            <form action="/user/<%= currentUser._id %>" method="POST" enctype="multipart/form-data">
                <input type="file" class="form-control" name="image" accept="image/*">
                <button type="submit">Submit</button>
            </form>
            
            <!-- <hr class="line"> -->
        </div>
        <div class="alert alert-success mypage-background" role="alert">
            <button id="sub-now" class="showing-movie decoration">Movie history</button>
            <button id="sub-come" class="coming-movie decoration">My favorite movie</button>
        </div>


        <div id="now-showing">
        
            <% if (currentUser) { %>
                <% Booking.forEach(function(thisReserve){ %>
                    <div class="alert alert-success mypage-background" role="alert">
                        <div class="album py-5">
                            <div class="container">
                                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                                    <div class="col">
                                        <div class="card shadow-sm bg-dark" style="width: 12rem;">
                                            <img src="<%= thisReserve.moviesImage %>"
                                                class="card-img-top">
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="history-block">
                            <p class="history-name-movie"><%= thisReserve.moviesName %></p>
                            <p>Date : <%= thisReserve.date %></p>
                            <p>Time : <%= thisReserve.time %></p>
                            <p>Cinema : <%= thisReserve.cinemaName %></p>
                            <p>Theater : <%= thisReserve.theater %></p>
                            <p>Seat no. : <%= thisReserve.seats %></p>
                        </div><br>
                        <hr class="line">
                    </div>
                <% }); %>
            <% } %>
        </div>

        <div id="coming-soon" class="hidden">

            <div class="album py-5">
                <div class="container">
                  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
        
                    <!-- picture and detail -->
        
                    <% if ( movie.likes == 0 ) {  %>
                      &ensp; <p class="dont-like"> You don't have a movie in your favorite. Let's add a movie to your favorite! </p> 
                  <% } else {  %>
                      <% movie.likes.forEach(function(liked){ %>
                          <div class="col">
                              <a href="/movie/<%= liked.movies.id %>" class="detail">
                                  <div class="card shadow-sm" style="width: 16rem;">
                                      <img src="<%= liked.movies.image %>" class="card-img-top">
                                      <div class="card-body">
                                          <h5 class="card-title">
                                              <%= liked.movies.name %>
                                          </h5>
                                          <p class="card-text">
                                              <%= liked.date %>
                                          </p>
                                      </div>
                                  </div>
                              </a>
                          </div>
                      <% }); %>
                  <% } %>
        
                    

                
                

        </div>
        
    </div>
        
        
        
                    
        
        
                   
        
        
               

   
<%- include('partials/footer.ejs') %>